
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Agar.io Visual+</title>
  <style>
    body,html{margin:0;padding:0;height:100%;overflow:hidden;background:#000;font-family:sans-serif}
    #gameContainer{position:relative;width:100vw;height:100vh;background:radial-gradient(circle at 20% 20%,#022,#000)}
    #gameCanvas{display:block;width:100%;height:100%;cursor:none;touch-action:none}
    #ui{position:absolute;top:10px;left:10px;color:#fff;z-index:10;font-weight:bold;background:rgba(0,0,0,.5);padding:8px 12px;border-radius:8px}
    #instructions{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;color:white;z-index:20}
    #instructions .box{background:rgba(0,0,0,.8);padding:20px;border-radius:12px;border:2px solid #00ff99;text-align:center;max-width:90%}
    #instructions button{margin-top:15px;padding:12px 24px;border:none;border-radius:8px;background:#00ff99;font-weight:bold;font-size:16px;cursor:pointer}
    #gameOver{position:absolute;inset:0;display:none;align-items:center;justify-content:center;color:white;z-index:20}
    #gameOver .box{background:rgba(0,0,0,.9);padding:20px;border-radius:12px;border:2px solid #ff4444;text-align:center}
    #gameOver button{margin-top:12px;padding:10px 20px;border:none;border-radius:8px;background:#00ff99;font-weight:bold}
    #minimapWrap{position:absolute;top:10px;right:10px;background:rgba(0,0,0,.6);padding:6px;border-radius:10px;display:none}
    #minimap{width:160px;height:120px;border-radius:8px;background:#011}
  </style>
</head>
<body>
  <div id="gameContainer">
    <canvas id="gameCanvas"></canvas>
    <div id="ui" class="hidden">PontuaÃ§Ã£o: <span id="score">0</span> â€¢ Massa: <span id="mass">10</span></div>
    <div id="instructions">
      <div class="box">
        <h1>ðŸ¦  Agar Visual+</h1>
        <p>Toque para andar â€¢ EspaÃ§o: dividir â€¢ R: reunir</p>
        <button id="startBtn">COMEÃ‡AR</button>
      </div>
    </div>
    <div id="gameOver">
      <div class="box">
        <h2>ðŸ’€ Game Over</h2>
        <p>PontuaÃ§Ã£o: <span id="finalScore">0</span> | Massa: <span id="finalMass">0</span></p>
        <button id="restartBtn">Jogar novamente</button>
      </div>
    </div>
    <div id="minimapWrap">
      <canvas id="minimap" width="160" height="120"></canvas>
    </div>
  </div>
<script>
// ====== Setup ======
const canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d");
const W=()=>window.innerWidth,H=()=>window.innerHeight;let DPR=window.devicePixelRatio||1;
function resize(){canvas.width=W()*DPR;canvas.height=H()*DPR;ctx.setTransform(DPR,0,0,DPR,0,0);}resize();window.addEventListener("resize",resize);
let gameRunning=false,player,enemies=[],food=[],score=0,viruses=[];
const WORLD_W=2200,WORLD_H=1600;

// ====== Player ======
function reset(){player={x:WORLD_W/2,y:WORLD_H/2,mass:15,radius:20,vx:0,vy:0};food=[];enemies=[];viruses=[];score=0;
for(let i=0;i<300;i++)food.push(randFruit());
for(let i=0;i<12;i++)spawnEnemy();
for(let i=0;i<10;i++)viruses.push({x:Math.random()*WORLD_W,y:Math.random()*WORLD_H,r:20});
}

// ====== Fruits ======
function randFruit(){return {x:Math.random()*WORLD_W,y:Math.random()*WORLD_H,r:8+Math.random()*5,kind:Math.floor(Math.random()*3)};}
function drawFruit(f){ctx.save();if(f.kind===0){ctx.fillStyle="#e33";ctx.beginPath();ctx.arc(f.x,f.y,f.r,0,Math.PI*2);ctx.fill();}else if(f.kind===1){ctx.fillStyle="#ff5";ctx.beginPath();ctx.ellipse(f.x,f.y,f.r, f.r*0.6,0,0,Math.PI*2);ctx.fill();}else{ctx.fillStyle="#95f";for(let i=0;i<6;i++){let ang=i*Math.PI/3;ctx.beginPath();ctx.arc(f.x+Math.cos(ang)*f.r*0.6,f.y+Math.sin(ang)*f.r*0.6,f.r*0.4,0,Math.PI*2);ctx.fill();}}ctx.restore();}

// ====== Enemies ======
function spawnEnemy(){let m=20+Math.random()*40;enemies.push({x:Math.random()*WORLD_W,y:Math.random()*WORLD_H,radius:Math.sqrt(m)*2+5,vx:Math.random()*2-1,vy:Math.random()*2-1,mass:m});}

// ====== Update ======
function update(){
  // move player
  player.x+=player.vx;player.y+=player.vy;
  player.x=Math.max(player.radius,Math.min(WORLD_W-player.radius,player.x));
  player.y=Math.max(player.radius,Math.min(WORLD_H-player.radius,player.y));

  // comer frutas
  for(let i=food.length-1;i>=0;i--){let f=food[i];if(Math.hypot(player.x-f.x,player.y-f.y)<player.radius+f.r){player.mass+=f.r*0.3;player.radius=Math.sqrt(player.mass)*2+5;score+=10;food.splice(i,1);}}

  // inimigos
  for(const e of enemies){e.x+=e.vx;e.y+=e.vy;if(e.x<e.radius||e.x>WORLD_W-e.radius)e.vx*=-1;if(e.y<e.radius||e.y>WORLD_H-e.radius)e.vy*=-1;}

  // colisÃµes simples
  for(const e of enemies){if(Math.hypot(player.x-e.x,player.y-e.y)<player.radius+e.radius){if(player.mass>e.mass*1.2){player.mass+=e.mass*0.5;player.radius=Math.sqrt(player.mass)*2+5;e.mass=20+Math.random()*40;e.radius=Math.sqrt(e.mass)*2+5;e.x=Math.random()*WORLD_W;e.y=Math.random()*WORLD_H;}else if(e.mass>player.mass*1.2){endGame();}}}
}

// ====== Render ======
function render(){ctx.setTransform(DPR,0,0,DPR,0,0);ctx.clearRect(0,0,W(),H());ctx.save();
ctx.translate(W()/2-player.x,H()/2-player.y);
ctx.fillStyle="#444";for(let i=0;i<food.length;i++)drawFruit(food[i]);
ctx.fillStyle="red";for(const v of viruses){ctx.beginPath();ctx.arc(v.x,v.y,v.r,0,Math.PI*2);ctx.fill();}
ctx.fillStyle="blue";ctx.beginPath();ctx.arc(player.x,player.y,player.radius,0,Math.PI*2);ctx.fill();
ctx.fillStyle="purple";for(const e of enemies){ctx.beginPath();ctx.arc(e.x,e.y,e.radius,0,Math.PI*2);ctx.fill();}
ctx.restore();document.getElementById("score").textContent=score;document.getElementById("mass").textContent=Math.floor(player.mass);}

// ====== Game loop ======
function loop(){if(!gameRunning)return;update();render();requestAnimationFrame(loop);}

// ====== Flow ======
function startGame(){reset();gameRunning=true;document.getElementById("instructions").style.display="none";document.getElementById("gameOver").style.display="none";document.getElementById("ui").classList.remove("hidden");document.getElementById("minimapWrap").style.display="block";loop();}
function endGame(){gameRunning=false;document.getElementById("finalScore").textContent=score;document.getElementById("finalMass").textContent=Math.floor(player.mass);document.getElementById("gameOver").style.display="flex";}

document.getElementById("startBtn").onclick=startGame;
document.getElementById("restartBtn").onclick=startGame;

// ====== Movimento por toque ======
canvas.addEventListener("touchstart",e=>{if(!gameRunning)return;let t=e.touches[0];let cx=W()/2,cy=H()/2;let dx=t.clientX-cx,dy=t.clientY-cy;let len=Math.hypot(dx,dy);player.vx=(dx/len)*2;player.vy=(dy/len)*2;},{passive:true});
</script>
</body>
</html>
